(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,120682,e=>{"use strict";var t=e.i(368340);let a=0,s=new Map,r=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),n({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},i=[],l={toasts:[]};function n(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?r(a):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),i.forEach(e=>{e(l)})}function c({...e}){let t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>n({type:"DISMISS_TOAST",toastId:t});return n({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>n({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function o(){let[e,a]=t.useState(l);return t.useEffect(()=>(i.push(a),()=>{let e=i.indexOf(a);e>-1&&i.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>n({type:"DISMISS_TOAST",toastId:e})}}e.s(["toast",()=>c,"useToast",()=>o])},813637,e=>{"use strict";let t=(0,e.i(510965).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>t],813637)},584675,e=>{"use strict";let t=(0,e.i(510965).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],584675)},358903,e=>{"use strict";var t=e.i(794313),a=e.i(801244),s=e.i(368340),r=e.i(167881),i=e.i(120682),l=e.i(584675),n=e.i(813637),c=e.i(44215),o=e.i(944908);function d(){let e=(0,a.useParams)(),d=(0,a.useRouter)(),{toast:u}=(0,i.useToast)(),m=(0,s.useRef)(null),p=(0,s.useRef)(null),[h,f]=(0,s.useState)(null),[g,x]=(0,s.useState)(!0),[j,v]=(0,s.useState)(!1);(0,s.useEffect)(()=>{e.id&&y()},[e.id]),(0,s.useEffect)(()=>{if(h?.template_json&&m.current)return(async()=>{let e="string"==typeof h.template_json?JSON.parse(h.template_json):h.template_json;console.log("Initializing canvas with dimensions:",e.width,"x",e.height),console.log("Template JSON objects count:",e.objects?.length),p.current&&(p.current.dispose(),p.current=null);let t=new o.Canvas(m.current,{width:e.width||900,height:e.height||506,selection:!1});p.current=t,console.log("Loading template JSON into canvas using Promise-based approach");try{await t.loadFromJSON(e),console.log("Template JSON loaded successfully"),console.log("Canvas objects after load:",t.getObjects().length),t.getObjects().forEach(e=>{if(("text"===e.type||"i-text"===e.type||"textbox"===e.type)&&e.text){let t=e.text;t=(t=(t=(t=t.replace(/{{student_name}}/g,"John Doe")).replace(/{{course_name}}/g,"Sample Course Title")).replace(/{{course_title}}/g,"Sample Course Title")).replace(/{{instructor_name}}/g,"Dr. Instructor Name");let a=new Date().toLocaleDateString();t=(t=(t=(t=t.replace(/{{date}}/g,a)).replace(/{{dateofIssue}}/g,a)).replace(/{{certificate_id}}/g,"CERT-PREVIEW-001")).replace(/{{certificateID}}/g,"CERT-PREVIEW-001"),e.set("text",t)}e.selectable=!1,e.evented=!1,e.hasControls=!1,e.hasBorders=!1}),t.selection=!1,t.hoverCursor="default",t.defaultCursor="default",t.renderAll(),v(!0),console.log("Canvas rendered with",t.getObjects().length,"objects")}catch(e){console.error("Error loading template JSON:",e),u({title:"Error",description:"Failed to load certificate template into canvas",variant:"destructive"})}})(),()=>{p.current&&(p.current.dispose(),p.current=null)}},[h]);let y=async()=>{try{x(!0),console.log("Fetching template details for ID:",e.id);let t=await c.default.get(`/certificate-templates/${e.id}`);console.log("Template response:",t),t.success&&t.data?.data?(console.log("Template data:",t.data.data),f(t.data.data)):u({title:"Error",description:"Failed to load certificate template",variant:"destructive"})}catch(e){console.error("Error fetching template:",e),u({title:"Error",description:"Failed to load certificate template",variant:"destructive"})}finally{x(!1)}};return g?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading certificate..."})]})}):h?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"container mx-auto p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:()=>d.push("/admin/certificates"),children:[(0,t.jsx)(l.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:h.name}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Certificate Preview"})]})]}),(0,t.jsxs)(r.Button,{onClick:()=>{if(!p.current)return void u({title:"Error",description:"Canvas not ready",variant:"destructive"});console.log("Downloading certificate");let e=p.current.toDataURL({format:"png",quality:1,multiplier:2}),t=document.createElement("a");t.href=e,t.download=`${h?.name||"certificate"}.png`,t.click(),u({title:"Certificate Downloaded",description:"Certificate has been saved to your device"})},className:"gap-2",disabled:!j,children:[(0,t.jsx)(n.Download,{className:"w-4 h-4"}),"Download"]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("div",{className:"border border-gray-300 shadow-md",children:(0,t.jsx)("canvas",{ref:m})})})}),(0,t.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Template Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600",children:"Template Name"}),(0,t.jsx)("p",{className:"font-medium",children:h.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600",children:"Variables"}),(0,t.jsx)("p",{className:"font-medium",children:h.vars?.join(", ")||"None"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600",children:"Created"}),(0,t.jsx)("p",{className:"font-medium",children:h.created_at?new Date(h.created_at).toLocaleDateString():"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600",children:"Last Updated"}),(0,t.jsx)("p",{className:"font-medium",children:h.updated_at?new Date(h.updated_at).toLocaleDateString():"N/A"})]})]})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Certificate not found"}),(0,t.jsxs)(r.Button,{onClick:()=>d.push("/admin/certificates"),children:[(0,t.jsx)(l.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Certificates"]})]})})}e.s(["default",()=>d])}]);